---
import { Button as ShadcnButton } from '../components/ui/button'; // Alias for shadcn Button
import { cn } from "@/lib/utils";

interface Props {
  href: string;
  variant?: 'primary' | 'secondary' | 'text';
  size?: 'sm' | 'md' | 'lg';
  color?: 'indigo' | 'white' | 'gray'; // Will be handled by classNames if not directly mapped by shadcn variant
  external?: boolean;
  class?: string;
}

const {
  href,
  variant = 'primary',
  size = 'md',
  color = 'indigo',
  external = false,
  class: className = '',
} = Astro.props;

let shadcnVariant: 'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link';
let shadcnSize: 'default' | 'sm' | 'lg' | 'icon';
let customClasses = '';

// Map variants
switch (variant) {
  case 'primary':
    shadcnVariant = 'default';
    if (color === 'white') {
        customClasses += ' bg-white text-indigo-600 hover:bg-indigo-50 focus-visible:outline-white';
    } else if (color === 'gray') {
        customClasses += ' bg-gray-900 dark:bg-gray-700 text-white shadow-sm hover:bg-gray-700 dark:hover:bg-gray-600 focus-visible:outline-gray-900';
    }
    break;
  case 'secondary':
    shadcnVariant = 'outline'; // Or 'secondary' if we want a filled secondary
    if (color === 'indigo') {
        customClasses += ' border-indigo-600 dark:border-indigo-400 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/30';
    } else if (color === 'white') {
        customClasses += ' border-white text-white hover:bg-white/10';
    } else if (color === 'gray') {
        customClasses += ' border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-800';
    }
    break;
  case 'text':
    shadcnVariant = 'link'; // 'link' or 'ghost'
    if (color === 'indigo') {
        customClasses += ' text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 dark:hover:text-indigo-300';
    } else if (color === 'white') {
        customClasses += ' text-white hover:text-indigo-100 dark:hover:text-indigo-200';
    } else if (color === 'gray') {
        customClasses += ' text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-300';
    }
    break;
  default:
    shadcnVariant = 'default';
}

// Map sizes
switch (size) {
    case 'sm':
        shadcnSize = 'sm';
        break;
    case 'lg':
        shadcnSize = 'lg';
        break;
    case 'md':
    default:
        shadcnSize = 'default'; // shadcn 'default' is typically 'md'
        break;
}

const externalProps = external
  ? {
      target: '_blank',
      rel: 'noopener noreferrer',
    }
  : {};
---

<ShadcnButton asChild variant={shadcnVariant} size={shadcnSize} className={cn(customClasses, className)}>
  <a href={href} {...externalProps}>
    <slot />
    {variant === 'text' && !className.includes('inline-flex') && (
      <span aria-hidden="true">â†’</span>
    )}
  </a>
</ShadcnButton>
