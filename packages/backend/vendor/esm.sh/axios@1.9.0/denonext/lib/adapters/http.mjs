/* esm.sh - axios@1.9.0/lib/adapters/http */
import __Process$ from "node:process";
import { Buffer as __Buffer$ } from "node:buffer";
var Gt=Object.defineProperty;var Yt=(s,t)=>{for(var o in t)Gt(s,o,{get:t[o],enumerable:!0})};import y from"../../unsafe/utils.mjs";import Z from"../../unsafe/core/settle.mjs";import Le from"../../unsafe/core/buildFullPath.mjs";import Be from"../../unsafe/helpers/buildURL.mjs";import Oe from"/proxy-from-env@^1.1.0?target=denonext";import Ce from"node:http";import _e from"node:https";import De from"node:util";import Ne from"/follow-redirects@^1.15.6?target=denonext";import U from"node:zlib";var ot="1.9.0";var Tt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};import nt from"../../unsafe/utils.mjs";function H(s,t,o,e,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),e&&(this.request=e),r&&(this.response=r,this.status=r.status?r.status:null)}nt.inherits(H,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:nt.toJSONObject(this.config),code:this.code,status:this.status}}});var Lt=H.prototype,Bt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{Bt[s]={value:s}});Object.defineProperties(H,Bt);Object.defineProperty(Lt,"isAxiosError",{value:!0});H.from=(s,t,o,e,r,i)=>{let n=Object.create(Lt);return nt.toFlatObject(s,n,function(u){return u!==Error.prototype},a=>a!=="isAxiosError"),H.call(n,s.message,t,o,e,r),n.cause=s,n.name=s.name,i&&Object.assign(n,i),n};var d=H;import Qt from"../../unsafe/utils.mjs";function Ot(s,t,o){d.call(this,s??"canceled",d.ERR_CANCELED,t,o),this.name="CanceledError"}Qt.inherits(Ot,d,{__CANCEL__:!0});var it=Ot;import te from"node:crypto";import Zt from"node:url";var Ct=Zt.URLSearchParams;import Xt from"/form-data@^4.0.0?target=denonext";var _t=Xt;var at="abcdefghijklmnopqrstuvwxyz",Dt="0123456789",Nt={DIGIT:Dt,ALPHA:at,ALPHA_DIGIT:at+at.toUpperCase()+Dt},ee=(s=16,t=Nt.ALPHA_DIGIT)=>{let o="",{length:e}=t,r=new Uint32Array(s);te.randomFillSync(r);for(let i=0;i<s;i++)o+=t[r[i]%e];return o},kt={isNode:!0,classes:{URLSearchParams:Ct,FormData:_t,Blob:typeof Blob<"u"&&Blob||null},ALPHABET:Nt,generateString:ee,protocols:["http","https","file","data"]};var ut={};Yt(ut,{hasBrowserEnv:()=>lt,hasStandardBrowserEnv:()=>re,hasStandardBrowserWebWorkerEnv:()=>se,navigator:()=>ct,origin:()=>oe});var lt=typeof globalThis<"u"&&typeof document<"u",ct=typeof navigator=="object"&&navigator||void 0,re=lt&&(!ct||["ReactNative","NativeScript","NS"].indexOf(ct.product)<0),se=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",oe=lt&&globalThis.location.href||"http://localhost";var D={...ut,...kt};function ft(s){let t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}var ne=/^(?:([^;]+);)?(?:[^;]+;)?(base64|),([\s\S]*)$/;function mt(s,t,o){let e=o&&o.Blob||D.classes.Blob,r=ft(s);if(t===void 0&&e&&(t=!0),r==="data"){s=r.length?s.slice(r.length+1):s;let i=ne.exec(s);if(!i)throw new d("Invalid URL",d.ERR_INVALID_URL);let n=i[1],a=i[2],u=i[3],f=__Buffer$.from(decodeURIComponent(u),a?"base64":"utf8");if(t){if(!e)throw new d("Blob is not supported",d.ERR_NOT_SUPPORT);return new e([f],{type:n})}return f}throw new d("Unsupported protocol "+r,d.ERR_NOT_SUPPORT)}import M from"node:stream";import p from"../../unsafe/utils.mjs";import ie from"../../unsafe/utils.mjs";var ae=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ut=s=>{let t={},o,e,r;return s&&s.split(`
`).forEach(function(n){r=n.indexOf(":"),o=n.substring(0,r).trim().toLowerCase(),e=n.substring(r+1).trim(),!(!o||t[o]&&ae[o])&&(o==="set-cookie"?t[o]?t[o].push(e):t[o]=[e]:t[o]=t[o]?t[o]+", "+e:e)}),t};var Pt=Symbol("internals");function W(s){return s&&String(s).trim().toLowerCase()}function K(s){return s===!1||s==null?s:p.isArray(s)?s.map(K):String(s)}function ce(s){let t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,e;for(;e=o.exec(s);)t[e[1]]=e[2];return t}var le=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function dt(s,t,o,e,r){if(p.isFunction(e))return e.call(this,t,o);if(r&&(t=o),!!p.isString(t)){if(p.isString(e))return t.indexOf(e)!==-1;if(p.isRegExp(e))return e.test(t)}}function ue(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,e)=>o.toUpperCase()+e)}function fe(s,t){let o=p.toCamelCase(" "+t);["get","set","has"].forEach(e=>{Object.defineProperty(s,e+o,{value:function(r,i,n){return this[e].call(this,t,r,i,n)},configurable:!0})})}var I=class{constructor(t){t&&this.set(t)}set(t,o,e){let r=this;function i(a,u,f){let m=W(u);if(!m)throw new Error("header name must be a non-empty string");let b=p.findKey(r,m);(!b||r[b]===void 0||f===!0||f===void 0&&r[b]!==!1)&&(r[b||u]=K(a))}let n=(a,u)=>p.forEach(a,(f,m)=>i(f,m,u));if(p.isPlainObject(t)||t instanceof this.constructor)n(t,o);else if(p.isString(t)&&(t=t.trim())&&!le(t))n(Ut(t),o);else if(p.isObject(t)&&p.isIterable(t)){let a={},u,f;for(let m of t){if(!p.isArray(m))throw TypeError("Object iterator must return a key-value pair");a[f=m[0]]=(u=a[f])?p.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}n(a,o)}else t!=null&&i(o,t,e);return this}get(t,o){if(t=W(t),t){let e=p.findKey(this,t);if(e){let r=this[e];if(!o)return r;if(o===!0)return ce(r);if(p.isFunction(o))return o.call(this,r,e);if(p.isRegExp(o))return o.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=W(t),t){let e=p.findKey(this,t);return!!(e&&this[e]!==void 0&&(!o||dt(this,this[e],e,o)))}return!1}delete(t,o){let e=this,r=!1;function i(n){if(n=W(n),n){let a=p.findKey(e,n);a&&(!o||dt(e,e[a],a,o))&&(delete e[a],r=!0)}}return p.isArray(t)?t.forEach(i):i(t),r}clear(t){let o=Object.keys(this),e=o.length,r=!1;for(;e--;){let i=o[e];(!t||dt(this,this[i],i,t,!0))&&(delete this[i],r=!0)}return r}normalize(t){let o=this,e={};return p.forEach(this,(r,i)=>{let n=p.findKey(e,i);if(n){o[n]=K(r),delete o[i];return}let a=t?ue(i):String(i).trim();a!==i&&delete o[i],o[a]=K(r),e[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){let o=Object.create(null);return p.forEach(this,(e,r)=>{e!=null&&e!==!1&&(o[r]=t&&p.isArray(e)?e.join(", "):e)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){let e=new this(t);return o.forEach(r=>e.set(r)),e}static accessor(t){let e=(this[Pt]=this[Pt]={accessors:{}}).accessors,r=this.prototype;function i(n){let a=W(n);e[a]||(fe(r,n),e[a]=!0)}return p.isArray(t)?t.forEach(i):i(t),this}};I.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);p.reduceDescriptors(I.prototype,({value:s},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(e){this[o]=e}}});p.freezeMethods(I);var G=I;import me from"node:stream";import zt from"../../unsafe/utils.mjs";var pt=Symbol("internals"),ht=class extends me.Transform{constructor(t){t=zt.toFlatObject(t,{maxRate:0,chunkSize:64*1024,minChunkSize:100,timeWindow:500,ticksRate:2,samplesCount:15},null,(e,r)=>!zt.isUndefined(r[e])),super({readableHighWaterMark:t.chunkSize});let o=this[pt]={timeWindow:t.timeWindow,chunkSize:t.chunkSize,maxRate:t.maxRate,minChunkSize:t.minChunkSize,bytesSeen:0,isCaptured:!1,notifiedBytesLoaded:0,ts:Date.now(),bytes:0,onReadCallback:null};this.on("newListener",e=>{e==="progress"&&(o.isCaptured||(o.isCaptured=!0))})}_read(t){let o=this[pt];return o.onReadCallback&&o.onReadCallback(),super._read(t)}_transform(t,o,e){let r=this[pt],i=r.maxRate,n=this.readableHighWaterMark,a=r.timeWindow,u=1e3/a,f=i/u,m=r.minChunkSize!==!1?Math.max(r.minChunkSize,f*.01):0,b=(R,h)=>{let g=__Buffer$.byteLength(R);r.bytesSeen+=g,r.bytes+=g,r.isCaptured&&this.emit("progress",r.bytesSeen),this.push(R)?__Process$.nextTick(h):r.onReadCallback=()=>{r.onReadCallback=null,__Process$.nextTick(h)}},O=(R,h)=>{let g=__Buffer$.byteLength(R),F=null,w=n,_,E=0;if(i){let N=Date.now();(!r.ts||(E=N-r.ts)>=a)&&(r.ts=N,_=f-r.bytes,r.bytes=_<0?-_:0,E=0),_=f-r.bytes}if(i){if(_<=0)return setTimeout(()=>{h(null,R)},a-E);_<w&&(w=_)}w&&g>w&&g-w>m&&(F=R.subarray(w),R=R.subarray(0,w)),b(R,F?()=>{__Process$.nextTick(h,null,F)}:h)};O(t,function R(h,g){if(h)return e(h);g?O(g,R):e(null)})}},yt=ht;import{EventEmitter as ke}from"node:events";import pe from"node:util";import{Readable as he}from"node:stream";import Q from"../../unsafe/utils.mjs";var{asyncIterator:Ft}=Symbol,de=async function*(s){s.stream?yield*s.stream():s.arrayBuffer?yield await s.arrayBuffer():s[Ft]?yield*s[Ft]():yield s},Y=de;var ye=D.ALPHABET.ALPHA_DIGIT+"-_",$=typeof TextEncoder=="function"?new TextEncoder:new pe.TextEncoder,z=`\r
`,be=$.encode(z),Re=2,bt=class{constructor(t,o){let{escapeName:e}=this.constructor,r=Q.isString(o),i=`Content-Disposition: form-data; name="${e(t)}"${!r&&o.name?`; filename="${e(o.name)}"`:""}${z}`;r?o=$.encode(String(o).replace(/\r?\n|\r\n?/g,z)):i+=`Content-Type: ${o.type||"application/octet-stream"}${z}`,this.headers=$.encode(i+z),this.contentLength=r?o.byteLength:o.size,this.size=this.headers.byteLength+this.contentLength+Re,this.name=t,this.value=o}async*encode(){yield this.headers;let{value:t}=this;Q.isTypedArray(t)?yield t:yield*Y(t),yield be}static escapeName(t){return String(t).replace(/[\r\n"]/g,o=>({"\r":"%0D","\n":"%0A",'"':"%22"})[o])}},Ee=(s,t,o)=>{let{tag:e="form-data-boundary",size:r=25,boundary:i=e+"-"+D.generateString(r,ye)}=o||{};if(!Q.isFormData(s))throw TypeError("FormData instance required");if(i.length<1||i.length>70)throw Error("boundary must be 10-70 characters long");let n=$.encode("--"+i+z),a=$.encode("--"+i+"--"+z),u=a.byteLength,f=Array.from(s.entries()).map(([b,O])=>{let R=new bt(b,O);return u+=R.size,R});u+=n.byteLength*f.length,u=Q.toFiniteNumber(u);let m={"Content-Type":`multipart/form-data; boundary=${i}`};return Number.isFinite(u)&&(m["Content-Length"]=u),t&&t(m),he.from(async function*(){for(let b of f)yield n,yield*b.encode();yield a}())},Ht=Ee;import xe from"node:stream";var Rt=class extends xe.Transform{__transform(t,o,e){this.push(t),e()}_transform(t,o,e){if(t.length!==0&&(this._transform=this.__transform,t[0]!==120)){let r=__Buffer$.alloc(2);r[0]=120,r[1]=156,this.push(r,o)}this.__transform(t,o,e)}},It=Rt;import Se from"../../unsafe/utils.mjs";var we=(s,t)=>Se.isAsyncFn(s)?function(...o){let e=o.pop();s.apply(this,o).then(r=>{try{t?e(null,...t(r)):e(null,r)}catch(i){e(i)}},e)}:s,Mt=we;function Ae(s,t){s=s||10;let o=new Array(s),e=new Array(s),r=0,i=0,n;return t=t!==void 0?t:1e3,function(u){let f=Date.now(),m=e[i];n||(n=f),o[r]=u,e[r]=f;let b=i,O=0;for(;b!==r;)O+=o[b++],b=b%s;if(r=(r+1)%s,r===i&&(i=(i+1)%s),f-n<t)return;let R=m&&f-m;return R?Math.round(O*1e3/R):void 0}}var qt=Ae;function ge(s,t){let o=0,e=1e3/t,r,i,n=(f,m=Date.now())=>{o=m,r=null,i&&(clearTimeout(i),i=null),s.apply(null,f)};return[(...f)=>{let m=Date.now(),b=m-o;b>=e?n(f,m):(r=f,i||(i=setTimeout(()=>{i=null,n(r)},e-b)))},()=>r&&n(r)]}var Wt=ge;import Te from"../../unsafe/utils.mjs";var Et=(s,t,o=3)=>{let e=0,r=qt(50,250);return Wt(i=>{let n=i.loaded,a=i.lengthComputable?i.total:void 0,u=n-e,f=r(u),m=n<=a;e=n;let b={loaded:n,total:a,progress:a?n/a:void 0,bytes:u,rate:f||void 0,estimated:f&&a&&m?(a-n)/f:void 0,event:i,lengthComputable:a!=null,[t?"download":"upload"]:!0};s(b)},o)},xt=(s,t)=>{let o=s!=null;return[e=>t[0]({lengthComputable:o,total:s,loaded:e}),t[1]]},St=s=>(...t)=>Te.asap(()=>s(...t));var $t={flush:U.constants.Z_SYNC_FLUSH,finishFlush:U.constants.Z_SYNC_FLUSH},Ue={flush:U.constants.BROTLI_OPERATION_FLUSH,finishFlush:U.constants.BROTLI_OPERATION_FLUSH},jt=y.isFunction(U.createBrotliDecompress),{http:Pe,https:ze}=Ne,Fe=/https:?/,Vt=D.protocols.map(s=>s+":"),Jt=(s,[t,o])=>(s.on("end",o).on("error",o),t);function He(s,t){s.beforeRedirects.proxy&&s.beforeRedirects.proxy(s),s.beforeRedirects.config&&s.beforeRedirects.config(s,t)}function wt(s,t,o){let e=t;if(!e&&e!==!1){let r=Oe.getProxyForUrl(o);r&&(e=new URL(r))}if(e){if(e.username&&(e.auth=(e.username||"")+":"+(e.password||"")),e.auth){(e.auth.username||e.auth.password)&&(e.auth=(e.auth.username||"")+":"+(e.auth.password||""));let i=__Buffer$.from(e.auth,"utf8").toString("base64");s.headers["Proxy-Authorization"]="Basic "+i}s.headers.host=s.hostname+(s.port?":"+s.port:"");let r=e.hostname||e.host;s.hostname=r,s.host=r,s.port=e.port,s.path=o,e.protocol&&(s.protocol=e.protocol.includes(":")?e.protocol:`${e.protocol}:`)}s.beforeRedirects.proxy=function(i){wt(i,t,i.href)}}var Ie=typeof __Process$<"u"&&y.kindOf(__Process$)==="process",Me=s=>new Promise((t,o)=>{let e,r,i=(u,f)=>{r||(r=!0,e&&e(u,f))},n=u=>{i(u),t(u)},a=u=>{i(u,!0),o(u)};s(n,a,u=>e=u).catch(a)}),qe=({address:s,family:t})=>{if(!y.isString(s))throw TypeError("address must be a string");return{address:s,family:t||(s.indexOf(".")<0?6:4)}},vt=(s,t)=>qe(y.isObject(s)?s:{address:s,family:t}),as=Ie&&function(t){return Me(async function(e,r,i){let{data:n,lookup:a,family:u}=t,{responseType:f,responseEncoding:m}=t,b=t.method.toUpperCase(),O,R=!1,h;if(a){let l=Mt(a,c=>y.isArray(c)?c:[c]);a=(c,S,P)=>{l(c,S,(x,k,rt)=>{if(x)return P(x);let C=y.isArray(k)?k.map(B=>vt(B)):[vt(k,rt)];S.all?P(x,C):P(x,C[0].address,C[0].family)})}}let g=new ke,F=()=>{t.cancelToken&&t.cancelToken.unsubscribe(w),t.signal&&t.signal.removeEventListener("abort",w),g.removeAllListeners()};i((l,c)=>{O=!0,c&&(R=!0,F())});function w(l){g.emit("abort",!l||l.type?new it(null,t,h):l)}g.once("abort",r),(t.cancelToken||t.signal)&&(t.cancelToken&&t.cancelToken.subscribe(w),t.signal&&(t.signal.aborted?w():t.signal.addEventListener("abort",w)));let _=Le(t.baseURL,t.url,t.allowAbsoluteUrls),E=new URL(_,D.hasBrowserEnv?D.origin:void 0),N=E.protocol||Vt[0];if(N==="data:"){let l;if(b!=="GET")return Z(e,r,{status:405,statusText:"method not allowed",headers:{},config:t});try{l=mt(t.url,f==="blob",{Blob:t.env&&t.env.Blob})}catch(c){throw d.from(c,d.ERR_BAD_REQUEST,t)}return f==="text"?(l=l.toString(m),(!m||m==="utf8")&&(l=y.stripBOM(l))):f==="stream"&&(l=M.Readable.from(l)),Z(e,r,{data:l,status:200,statusText:"OK",headers:new G,config:t})}if(Vt.indexOf(N)===-1)return r(new d("Unsupported protocol "+N,d.ERR_BAD_REQUEST,t));let L=G.from(t.headers).normalize();L.set("User-Agent","axios/"+ot,!1);let{onUploadProgress:X,onDownloadProgress:tt}=t,j=t.maxRate,V,J;if(y.isSpecCompliantForm(n)){let l=L.getContentType(/boundary=([-_\w\d]{10,70})/i);n=Ht(n,c=>{L.set(c)},{tag:`axios-${ot}-boundary`,boundary:l&&l[1]||void 0})}else if(y.isFormData(n)&&y.isFunction(n.getHeaders)){if(L.set(n.getHeaders()),!L.hasContentLength())try{let l=await De.promisify(n.getLength).call(n);Number.isFinite(l)&&l>=0&&L.setContentLength(l)}catch{}}else if(y.isBlob(n)||y.isFile(n))n.size&&L.setContentType(n.type||"application/octet-stream"),L.setContentLength(n.size||0),n=M.Readable.from(Y(n));else if(n&&!y.isStream(n)){if(!__Buffer$.isBuffer(n))if(y.isArrayBuffer(n))n=__Buffer$.from(new Uint8Array(n));else if(y.isString(n))n=__Buffer$.from(n,"utf-8");else return r(new d("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",d.ERR_BAD_REQUEST,t));if(L.setContentLength(n.length,!1),t.maxBodyLength>-1&&n.length>t.maxBodyLength)return r(new d("Request body larger than maxBodyLength limit",d.ERR_BAD_REQUEST,t))}let Kt=y.toFiniteNumber(L.getContentLength());y.isArray(j)?(V=j[0],J=j[1]):V=J=j,n&&(X||V)&&(y.isStream(n)||(n=M.Readable.from(n,{objectMode:!1})),n=M.pipeline([n,new yt({maxRate:y.toFiniteNumber(V)})],y.noop),X&&n.on("progress",Jt(n,xt(Kt,Et(St(X),!1,3)))));let q;if(t.auth){let l=t.auth.username||"",c=t.auth.password||"";q=l+":"+c}if(!q&&E.username){let l=E.username,c=E.password;q=l+":"+c}q&&L.delete("authorization");let At;try{At=Be(E.pathname+E.search,t.params,t.paramsSerializer).replace(/^\?/,"")}catch(l){let c=new Error(l.message);return c.config=t,c.url=t.url,c.exists=!0,r(c)}L.set("Accept-Encoding","gzip, compress, deflate"+(jt?", br":""),!1);let T={path:At,method:b,headers:L.toJSON(),agents:{http:t.httpAgent,https:t.httpsAgent},auth:q,protocol:N,family:u,beforeRedirect:He,beforeRedirects:{}};!y.isUndefined(a)&&(T.lookup=a),t.socketPath?T.socketPath=t.socketPath:(T.hostname=E.hostname.startsWith("[")?E.hostname.slice(1,-1):E.hostname,T.port=E.port,wt(T,t.proxy,N+"//"+E.hostname+(E.port?":"+E.port:"")+T.path));let v,et=Fe.test(T.protocol);if(T.agent=et?t.httpsAgent:t.httpAgent,t.transport?v=t.transport:t.maxRedirects===0?v=et?_e:Ce:(t.maxRedirects&&(T.maxRedirects=t.maxRedirects),t.beforeRedirect&&(T.beforeRedirects.config=t.beforeRedirect),v=et?ze:Pe),t.maxBodyLength>-1?T.maxBodyLength=t.maxBodyLength:T.maxBodyLength=1/0,t.insecureHTTPParser&&(T.insecureHTTPParser=t.insecureHTTPParser),h=v.request(T,function(c){if(h.destroyed)return;let S=[c],P=+c.headers["content-length"];if(tt||J){let B=new yt({maxRate:y.toFiniteNumber(J)});tt&&B.on("progress",Jt(B,xt(P,Et(St(tt),!0,3)))),S.push(B)}let x=c,k=c.req||h;if(t.decompress!==!1&&c.headers["content-encoding"])switch((b==="HEAD"||c.statusCode===204)&&delete c.headers["content-encoding"],(c.headers["content-encoding"]||"").toLowerCase()){case"gzip":case"x-gzip":case"compress":case"x-compress":S.push(U.createUnzip($t)),delete c.headers["content-encoding"];break;case"deflate":S.push(new It),S.push(U.createUnzip($t)),delete c.headers["content-encoding"];break;case"br":jt&&(S.push(U.createBrotliDecompress(Ue)),delete c.headers["content-encoding"])}x=S.length>1?M.pipeline(S,y.noop):S[0];let rt=M.finished(x,()=>{rt(),F()}),C={status:c.statusCode,statusText:c.statusMessage,headers:new G(c.headers),config:t,request:k};if(f==="stream")C.data=x,Z(e,r,C);else{let B=[],gt=0;x.on("data",function(A){B.push(A),gt+=A.length,t.maxContentLength>-1&&gt>t.maxContentLength&&(R=!0,x.destroy(),r(new d("maxContentLength size of "+t.maxContentLength+" exceeded",d.ERR_BAD_RESPONSE,t,k)))}),x.on("aborted",function(){if(R)return;let A=new d("stream has been aborted",d.ERR_BAD_RESPONSE,t,k);x.destroy(A),r(A)}),x.on("error",function(A){h.destroyed||r(d.from(A,null,t,k))}),x.on("end",function(){try{let A=B.length===1?B[0]:__Buffer$.concat(B);f!=="arraybuffer"&&(A=A.toString(m),(!m||m==="utf8")&&(A=y.stripBOM(A))),C.data=A}catch(A){return r(d.from(A,null,t,C.request,C))}Z(e,r,C)})}g.once("abort",B=>{x.destroyed||(x.emit("error",B),x.destroy())})}),g.once("abort",l=>{r(l),h.destroy(l)}),h.on("error",function(c){r(d.from(c,null,t,h))}),h.on("socket",function(c){c.setKeepAlive(!0,1e3*60)}),t.timeout){let l=parseInt(t.timeout,10);if(Number.isNaN(l)){r(new d("error trying to parse `config.timeout` to int",d.ERR_BAD_OPTION_VALUE,t,h));return}h.setTimeout(l,function(){if(O)return;let S=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",P=t.transitional||Tt;t.timeoutErrorMessage&&(S=t.timeoutErrorMessage),r(new d(S,P.clarifyTimeoutError?d.ETIMEDOUT:d.ECONNABORTED,t,h)),w()})}if(y.isStream(n)){let l=!1,c=!1;n.on("end",()=>{l=!0}),n.once("error",S=>{c=!0,h.destroy(S)}),n.on("close",()=>{!l&&!c&&w(new it("Request stream has been aborted",t,h))}),n.pipe(h)}else h.end(n)})},cs=wt;export{cs as __setProxy,as as default};

import "https://deno.land/x/xhr@0.3.0/mod.ts";//# sourceMappingURL=http.mjs.map